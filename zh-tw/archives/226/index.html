<!doctype html><html lang=zh-tw dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="ğŸ“¢ æœ¬æ–‡ç”± gemini-2.5-flash ç¿»è­¯ Elasticsearch ç³»åˆ—\n"><title>Elasticsearch å…¥é–€</title>
<link rel=canonical href=https://blog.yexca.net/zh-tw/archives/226/><link rel=stylesheet href=/scss/style.min.79e65cda61d3f6f6cb935a8c05fb64fb839474529dd1c9ab2e552270ef816b46.css><meta property='og:title' content="Elasticsearch å…¥é–€"><meta property='og:description' content="ğŸ“¢ æœ¬æ–‡ç”± gemini-2.5-flash ç¿»è­¯ Elasticsearch ç³»åˆ—\n"><meta property='og:url' content='https://blog.yexca.net/zh-tw/archives/226/'><meta property='og:site_name' content="yexca'Blog"><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='å¾Œç«¯æŠ€è¡“'><meta property='article:tag' content='Elasticsearch'><meta property='article:tag' content='SpringCloud'><meta property='article:published_time' content='2025-01-29T23:38:51+09:00'><meta property='article:modified_time' content='2025-02-15T17:17:08+09:00'><meta name=twitter:site content="@yexcano"><meta name=twitter:creator content="@yexcano"><meta name=twitter:title content="Elasticsearch å…¥é–€"><meta name=twitter:description content="ğŸ“¢ æœ¬æ–‡ç”± gemini-2.5-flash ç¿»è­¯ Elasticsearch ç³»åˆ—\n"><link rel="shortcut icon" href=/favicon.ico><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.yexca.net\/zh-tw\/archives\/226\/"},"headline":"Elasticsearch å…¥é–€","name":"yexca'Blog","author":{"@type":"Person","name":"yexca"},"publisher":{"@type":"Person","name":"yexca'Blog"},"datePublished":"2025-01-29","dateModified":"2025-02-15","inLanguage":"zh-tw","description":"yexca çš„æŠ€è¡“èˆ‡ç”Ÿæ´»éƒ¨è½æ ¼ï¼Œç´€éŒ„ç¨‹å¼å­¸ç¿’èˆ‡æ—¥å¸¸éš¨ç­†ã€‚"}</script><link rel=alternate hreflang=x-default href=https://blog.yexca.net/><link rel=alternate hreflang=zh-CN href=https://blog.yexca.net/><link rel=alternate hreflang=zh-TW href=https://blog.yexca.net/zh-tw/><link rel=alternate hreflang=ja href=https://blog.yexca.net/ja/><link rel=alternate hreflang=en href=https://blog.yexca.net/en/><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Comic+Neue:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Noto+Sans+JP:wght@100..900&family=Noto+Sans+SC:wght@100..900&family=Noto+Sans+TC:wght@100..900&family=Yomogi&display=swap" rel=stylesheet></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ›é¸å–®>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/zh-tw/><img src=/img/avatar_hu16531030078560657968.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/zh-tw>yexca'Blog</a></h1><h2 class=site-description>æŠŠé€™å€‹ä¸ç¾å¥½çš„ä¸–ç•Œï¼Œç·¨ç¨‹æ‚¨æ‰€æœŸæœ›çš„æ¨£å­å§ï¼</h2></div></header><ol class=menu-social><li><a href=https://github.com/yexca target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:blog@yexca.net target=_blank title=Mail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://t.me/yexca target=_blank title=Telegram rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-telegram"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li><li><a href=/zh-tw/feed.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/zh-tw/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>é¦–é </span></a></li><li><a href=/zh-tw/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>æª”æ¡ˆ</span></a></li><li><a href=/zh-tw/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>æœå°‹</span></a></li><li><a href=/zh-tw/background/><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>èƒŒæ™¯</span></a></li><li><a href=/zh-tw/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>é€£çµ</span></a></li><li><a href=/zh-tw/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>é—œæ–¼</span></a></li><li><a href=/zh-tw/support/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-coffee"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 14c.83.642 2.077 1.017 3.5 1 1.423.017 2.67-.358 3.5-1s2.077-1.017 3.5-1c1.423-.017 2.67.358 3.5 1"/><path d="M8 3A2.4 2.4.0 007 5a2.4 2.4.0 001 2"/><path d="M12 3a2.4 2.4.0 00-1 2 2.4 2.4.0 001 2"/><path d="M3 10h14v5a6 6 0 01-6 6H9a6 6 0 01-6-6v-5z"/><path d="M16.746 16.726a3 3 0 10.252-5.555"/></svg>
<span>æ”¯æŒ</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://blog.yexca.net/>ç®€ä½“ä¸­æ–‡</option><option value=https://blog.yexca.net/zh-tw/ selected>ç¹é«”ä¸­æ–‡</option><option value=https://blog.yexca.net/en/>English</option><option value=https://blog.yexca.net/ja/>æ—¥æœ¬èª</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>å¤œæ™šæ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®éŒ„</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#æ­£å‘ç´¢å¼•>æ­£å‘ç´¢å¼•</a></li><li><a href=#å€’æ’ç´¢å¼•>å€’æ’ç´¢å¼•</a><ul><li><a href=#æ–‡ä»¶-document>æ–‡ä»¶ (Document)</a></li><li><a href=#ç´¢å¼•èˆ‡æ˜ å°„-mapping>ç´¢å¼•èˆ‡æ˜ å°„ (Mapping)</a></li></ul></li><li><a href=#mysql-èˆ‡-elasticsearch>MySQL èˆ‡ Elasticsearch</a><ul><li><a href=#å„ªç¼ºé»>å„ªç¼ºé»</a></li></ul></li><li><a href=#å®‰è£>å®‰è£</a><ul><li><a href=#elasticsearch>Elasticsearch</a></li><li><a href=#kibana>Kibana</a></li><li><a href=#ik-æ–·è©å™¨>IK æ–·è©å™¨</a></li></ul></li><li><a href=#dsl-ç´¢å¼•åº«æ“ä½œ>DSL ç´¢å¼•åº«æ“ä½œ</a><ul><li><a href=#mapping-æ˜ å°„å±¬æ€§>Mapping æ˜ å°„å±¬æ€§</a></li><li><a href=#å»ºç«‹ç´¢å¼•åº«>å»ºç«‹ç´¢å¼•åº«</a></li><li><a href=#æŸ¥è©¢ç´¢å¼•åº«>æŸ¥è©¢ç´¢å¼•åº«</a></li><li><a href=#ä¿®æ”¹ç´¢å¼•åº«>ä¿®æ”¹ç´¢å¼•åº«</a></li><li><a href=#åˆªé™¤ç´¢å¼•åº«>åˆªé™¤ç´¢å¼•åº«</a></li><li><a href=#ç´¢å¼•åº«æ“ä½œç¸½çµ>ç´¢å¼•åº«æ“ä½œç¸½çµ</a></li></ul></li><li><a href=#dsl-æ–‡ä»¶æ“ä½œ>DSL æ–‡ä»¶æ“ä½œ</a><ul><li><a href=#æ–°å¢æ–‡ä»¶>æ–°å¢æ–‡ä»¶</a></li><li><a href=#æŸ¥è©¢æ–‡ä»¶>æŸ¥è©¢æ–‡ä»¶</a></li><li><a href=#ä¿®æ”¹æ–‡ä»¶>ä¿®æ”¹æ–‡ä»¶</a></li><li><a href=#åˆªé™¤æ–‡ä»¶>åˆªé™¤æ–‡ä»¶</a></li><li><a href=#æ–‡ä»¶æ“ä½œç¸½çµ>æ–‡ä»¶æ“ä½œç¸½çµ</a></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/zh-tw/categories/%E6%8A%80%E8%A1%93%E5%AD%B8%E7%BF%92/>æŠ€è¡“å­¸ç¿’</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/zh-tw/archives/226/>Elasticsearch å…¥é–€</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025-01-29 23:38 +0900</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é–±è®€æ™‚é–“: 12 åˆ†é˜</time></div></footer><footer class=post-tags><svg class="icon icon-tabler icon-tabler-tag" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7v3l9 9 7-7-9-9H8A2 2 0 006 5"/><path d="M9 8h-.01"/></svg>
<a href=/zh-tw/tags/%E5%BE%8C%E7%AB%AF%E6%8A%80%E8%A1%93/ target=_blank class="tag badge badge-secondary post-meta-detail-tag">å¾Œç«¯æŠ€è¡“</a>
<a href=/zh-tw/tags/elasticsearch/ target=_blank class="tag badge badge-secondary post-meta-detail-tag">Elasticsearch</a>
<a href=/zh-tw/tags/springcloud/ target=_blank class="tag badge badge-secondary post-meta-detail-tag">SpringCloud</a></footer><footer class=article-translations><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://blog.yexca.net/archives/226/ class=link>ç®€ä½“ä¸­æ–‡</a>
<a href=https://blog.yexca.net/en/archives/226/ class=link>English</a>
<a href=https://blog.yexca.net/ja/archives/226/ class=link>æ—¥æœ¬èª</a></div></footer></div></header><section class=article-content><div class=notice><strong>ğŸ“¢</strong> æœ¬æ–‡ç”± gemini-2.5-flash ç¿»è­¯</div><style lang=scss>.notice{padding:.75em 1em;margin:1em 0;border-left:4px solid;border-radius:4px;&.default { border-color: #ccc; background-color: #f9f9f9; color: #333; } &.info { border-color: #2196f3; background-color: #e3f2fd; color: #1a237e; } &.warn { border-color: #ff9800; background-color: #fff3e0; color: #e65100; } &.danger { border-color: #f44336; background-color: #ffebee; color: #b71c1c; }}[data-scheme=dark]{.notice { &.default { border-color: #666; background-color: #2a2a2a; color: #eee; } &.info { border-color: #90caf9; background-color: #1e3a5f; color: #e3f2fd; } &.warn { border-color: #ffb74d; background-color: #4e342e; color: #fff3e0; } &.danger { border-color: #ef5350; background-color: #3e2723; color: #ffebee; } }}[data-scheme=sepia]{.notice { &.info { border-color: #6a5acd; background-color: #fdf6e3; color: #3c2f2f; } &.warn { border-color: #e9967a; background-color: #faf0e6; color: #5c4033; } &.danger { border-color: #cd5c5c; background-color: #f5e0dc; color: #7b3f3f; } }}</style><blockquote><p><strong>Elasticsearch ç³»åˆ—</strong></p><div class=table-wrapper><table><thead><tr><th style=text-align:left>å…§å®¹</th><th style=text-align:left>é€£çµ</th></tr></thead><tbody><tr><td style=text-align:left>Elasticsearch åŸºç¤æ“ä½œ</td><td style=text-align:left>æœ¬æ–‡</td></tr><tr><td style=text-align:left>Elasticsearch æŸ¥è©¢æ“ä½œ</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/227>https://blog.yexca.net/zh-tw/archives/227</a></td></tr><tr><td style=text-align:left>RestClient åŸºç¤æ“ä½œ</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/228>https://blog.yexca.net/zh-tw/archives/228</a></td></tr><tr><td style=text-align:left>RestClient æŸ¥è©¢æ“ä½œ</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/229>https://blog.yexca.net/zh-tw/archives/229</a></td></tr><tr><td style=text-align:left>Elasticsearch è³‡æ–™èšåˆ</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/231>https://blog.yexca.net/zh-tw/archives/231</a></td></tr><tr><td style=text-align:left>Elasticsearch è‡ªå‹•è£œé½Š</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/232>https://blog.yexca.net/zh-tw/archives/232</a></td></tr><tr><td style=text-align:left>Elasticsearch è³‡æ–™åŒæ­¥</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/234>https://blog.yexca.net/zh-tw/archives/234</a></td></tr><tr><td style=text-align:left>Elasticsearch å¢é›†</td><td style=text-align:left><a class=link href=https://blog.yexca.net/zh-tw/archives/235>https://blog.yexca.net/zh-tw/archives/235</a></td></tr></tbody></table></div></blockquote><p>Elasticsearch æ˜¯ä¸€æ¬¾éå¸¸å¼·å¤§çš„é–‹æºæœå°‹å¼•æ“è»Ÿé«”ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘å¾æµ·é‡è³‡æ–™ä¸­å¿«é€Ÿæ‰¾åˆ°éœ€è¦çš„å…§å®¹ã€‚çµåˆ Kibanaã€Logstashã€Beatsï¼Œä¹Ÿå°±æ˜¯ Elastic Stack (ELK)ã€‚è¢«å»£æ³›æ‡‰ç”¨åœ¨æ—¥èªŒè³‡æ–™åˆ†æã€å³æ™‚ç›£æ§ç­‰é ˜åŸŸã€‚</p><p>è€Œ Elasticsearch æ˜¯ Elastic Stack çš„æ ¸å¿ƒï¼Œè² è²¬å„²å­˜ã€æœå°‹ã€åˆ†æè³‡æ–™ã€‚</p><p>Elasticsearch åº•å±¤åŸºæ–¼ Lucene å¯¦ä½œï¼ŒLucene ç‚º Java çš„ä¸€å€‹æœå°‹å¼•æ“å‡½å¼åº«ã€‚</p><h2 id=æ­£å‘ç´¢å¼•>æ­£å‘ç´¢å¼•</h2><p>å‚³çµ±è³‡æ–™åº« (ä¾‹å¦‚ MySQL) æ¡ç”¨æ­£å‘ç´¢å¼•ï¼Œèˆ‰ä¾‹ä¾†èªªä¸‹è¡¨ï¼š</p><div class=table-wrapper><table><thead><tr><th>id</th><th>title</th><th>price</th></tr></thead><tbody><tr><td>1</td><td>å°ç±³æ‰‹æ©Ÿ</td><td>3499</td></tr><tr><td>2</td><td>è¯ç‚ºæ‰‹æ©Ÿ</td><td>4999</td></tr><tr><td>3</td><td>è¯ç‚ºå°ç±³å……é›»å™¨</td><td>49</td></tr><tr><td>4</td><td>å°ç±³æ‰‹ç’°</td><td>239</td></tr></tbody></table></div><p>å¦‚æœåŸºæ–¼ id ç²¾æº–æŸ¥è©¢ï¼Œç›´æ¥èµ°ç´¢å¼•æœƒå¾ˆå¿«ã€‚</p><p>ä½†è‹¥åŸºæ–¼ title åšæ¨¡ç³ŠæŸ¥è©¢ï¼Œåªèƒ½é€è¡Œæƒæè³‡æ–™ï¼Œæµç¨‹ï¼š</p><ol><li>ä½¿ç”¨è€…æœå°‹ <em>æ‰‹æ©Ÿ</em>ï¼Œè³‡æ–™åº«æ¢ä»¶ <code>%æ‰‹æ©Ÿ%</code></li><li>é€è¡Œå–å¾—è³‡æ–™ï¼Œå¦‚ id ç‚º 1 çš„è³‡æ–™</li><li>åˆ¤æ–·è³‡æ–™ä¸­çš„ title æ˜¯å¦ç¬¦åˆæ¢ä»¶</li><li>ç¬¦åˆå‰‡æ”¾å…¥ï¼Œä¸ç¬¦åˆå‰‡æ¨æ£„ï¼Œä¸‹ä¸€è¡Œ</li></ol><p>éš¨è‘—è³‡æ–™é‡çš„å¢åŠ ï¼Œé€è¡Œæƒæçš„æ•ˆç‡è¶Šä¾†è¶Šä½ã€‚</p><h2 id=å€’æ’ç´¢å¼•>å€’æ’ç´¢å¼•</h2><p>å€’æ’ç´¢å¼•çš„æ¦‚å¿µæ˜¯åŸºæ–¼ MySQL é€™æ¨£çš„æ­£å‘ç´¢å¼•è€Œè¨€çš„ã€‚</p><p>Elasticsearch æ¡ç”¨å€’æ’ç´¢å¼•ï¼Œæ¦‚å¿µï¼š</p><ul><li>æ–‡ä»¶ (document)ï¼šæ¯ç­†è³‡æ–™å°±æ˜¯ä¸€å€‹æ–‡ä»¶ã€‚</li><li>è©æ¢ (term)ï¼šæ–‡ä»¶æŒ‰ç…§èªç¾©åˆ†æˆçš„è©èªã€‚</li></ul><p>å»ºç«‹å€’æ’ç´¢å¼•æ˜¯å°æ­£å‘ç´¢å¼•çš„ä¸€ç¨®ç‰¹æ®Šè™•ç†ï¼Œæµç¨‹ï¼š</p><ol><li>å°‡æ¯ä¸€å€‹æ–‡ä»¶çš„è³‡æ–™åˆ©ç”¨æ¼”ç®—æ³•æ–·è©ï¼Œå¾—åˆ°ä¸€å€‹å€‹è©æ¢ã€‚</li><li>å»ºç«‹è¡¨ï¼Œæ¯è¡ŒåŒ…æ‹¬è©æ¢ã€è©æ¢æ‰€åœ¨æ–‡ä»¶ idã€ä½ç½®ç­‰è³‡è¨Šã€‚</li><li>å› ç‚ºè©æ¢çš„å”¯ä¸€æ€§ï¼Œå¯ä»¥çµ¦è©æ¢å»ºç«‹ç´¢å¼•ï¼Œä¾‹å¦‚é›œæ¹Šè¡¨çµæ§‹ç´¢å¼•ã€‚</li></ol><p>èˆ‰ä¾‹ä¾†èªªä¸Šä¾‹çš„è¡¨å¯ä»¥å»ºç«‹å¦‚ä¸‹å€’æ’ç´¢å¼•ï¼š</p><div class=table-wrapper><table><thead><tr><th>è©æ¢</th><th>æ–‡ä»¶ id</th></tr></thead><tbody><tr><td>å°ç±³</td><td>1ï¼Œ3ï¼Œ4</td></tr><tr><td>æ‰‹æ©Ÿ</td><td>1ï¼Œ2</td></tr><tr><td>è¯ç‚º</td><td>2ï¼Œ3</td></tr><tr><td>å……é›»å™¨</td><td>3</td></tr><tr><td>æ‰‹ç’°</td><td>4</td></tr></tbody></table></div><p>å€’æ’ç´¢å¼•æœå°‹æµç¨‹ï¼š</p><ol><li>ä½¿ç”¨è€…æœå°‹ <code>å°ç±³æ‰‹æ©Ÿ</code>ã€‚</li><li>å°æœå°‹å…§å®¹æ–·è©ï¼Œå¾—åˆ° <code>å°ç±³</code>ã€<code>æ‰‹æ©Ÿ</code>ã€‚</li><li>ä½¿ç”¨è©æ¢åœ¨å€’æ’ç´¢å¼•æŸ¥æ‰¾ï¼Œå¾—åˆ°åŒ…å«è©æ¢çš„æ–‡ä»¶ idï¼š1ã€2ã€3ã€4ã€‚</li><li>ä½¿ç”¨æ–‡ä»¶ id åˆ°æ­£å‘ç´¢å¼•ä¸­æŸ¥æ‰¾å…·é«”æ–‡ä»¶ã€‚</li></ol><h3 id=æ–‡ä»¶-document>æ–‡ä»¶ (Document)</h3><p>Elasticsearch æ˜¯é¢å‘æ–‡ä»¶å„²å­˜çš„ï¼Œå¯ä»¥æ˜¯è³‡æ–™åº«ä¸­çš„ä¸€ç­†å•†å“è³‡æ–™ã€ä¸€å€‹è¨‚å–®è³‡è¨Šã€‚æ–‡ä»¶è³‡æ–™æœƒè¢«åºåˆ—åŒ–ç‚º JSON æ ¼å¼å¾Œå„²å­˜åœ¨ Elasticsearch ä¸­ã€‚</p><p>ä¸Šè¿°æ­£å‘ç´¢å¼•è¡¨çš„ JSON å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;å°ç±³æ‰‹æ©Ÿ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;price&#34;</span><span class=p>:</span> <span class=mi>3499</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;è¯ç‚ºæ‰‹æ©Ÿ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;price&#34;</span><span class=p>:</span> <span class=mi>4999</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;è¯ç‚ºå°ç±³å……é›»å™¨&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;price&#34;</span><span class=p>:</span> <span class=mi>49</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;å°ç±³æ‰‹ç’°&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;price&#34;</span><span class=p>:</span> <span class=mi>299</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ Json æ–‡ä»¶ä¸­åŒ…å«è¨±å¤šæ¬„ä½ï¼Œé¡ä¼¼æ–¼è³‡æ–™åº«ä¸­çš„æ¬„ã€‚</p><h3 id=ç´¢å¼•èˆ‡æ˜ å°„-mapping>ç´¢å¼•èˆ‡æ˜ å°„ (Mapping)</h3><p>ç´¢å¼• (index) ç‚ºç›¸åŒå‹åˆ¥çš„æ–‡ä»¶é›†åˆã€‚</p><p>æ˜ å°„ (mapping) ç‚ºç´¢å¼•ä¸­æ–‡ä»¶çš„æ¬„ä½é™åˆ¶è³‡è¨Šï¼Œé¡ä¼¼æ–¼è³‡æ–™è¡¨çš„çµæ§‹é™åˆ¶ã€‚</p><p>å¯ä»¥æŠŠç´¢å¼•ç•¶åšæ˜¯è³‡æ–™åº«ä¸­çš„è³‡æ–™è¡¨ï¼Œè³‡æ–™åº«çš„è³‡æ–™è¡¨æœƒæœ‰é™åˆ¶è³‡è¨Šï¼Œç”¨ä¾†å®šç¾©è¡¨çš„çµæ§‹ã€æ¬„ä½çš„åç¨±ã€å‹åˆ¥ç­‰è³‡è¨Šã€‚å› æ­¤ï¼Œç´¢å¼•åº«ä¸­å°±æœ‰æ˜ å°„ï¼Œæ˜¯ç´¢å¼•ä¸­æ–‡ä»¶çš„æ¬„ä½é™åˆ¶è³‡è¨Šï¼Œé¡ä¼¼æ–¼è³‡æ–™è¡¨çš„çµæ§‹é™åˆ¶ã€‚</p><h2 id=mysql-èˆ‡-elasticsearch>MySQL èˆ‡ Elasticsearch</h2><div class=table-wrapper><table><thead><tr><th>MySQL</th><th>Elasticsearch</th><th>èªªæ˜</th></tr></thead><tbody><tr><td>Table</td><td>Index</td><td>ç´¢å¼• (index)ï¼Œå°±æ˜¯æ–‡ä»¶çš„é›†åˆï¼Œé¡ä¼¼è³‡æ–™åº«çš„è³‡æ–™è¡¨ (table)</td></tr><tr><td>Row</td><td>Document</td><td>æ–‡ä»¶ (Document)ï¼Œå°±æ˜¯ä¸€ç­†ç­†çš„è³‡æ–™ï¼Œé¡ä¼¼è³‡æ–™åº«ä¸­çš„è³‡æ–™åˆ— (Row)ï¼Œæ–‡ä»¶éƒ½æ˜¯ JSON æ ¼å¼</td></tr><tr><td>Column</td><td>Field</td><td>æ¬„ä½ (Field)ï¼Œå°±æ˜¯ JSON æ–‡ä»¶ä¸­çš„æ¬„ä½ï¼Œé¡ä¼¼è³‡æ–™åº«ä¸­çš„æ¬„ (Column)</td></tr><tr><td>Schema</td><td>Mapping</td><td>Mapping (æ˜ å°„) æ˜¯ç´¢å¼•ä¸­æ–‡ä»¶çš„é™åˆ¶ï¼Œä¾‹å¦‚æ¬„ä½å‹åˆ¥é™åˆ¶ã€‚é¡ä¼¼è³‡æ–™åº«çš„ç¶±è¦ (Schema)</td></tr><tr><td>SQL</td><td>DSL</td><td>DSL æ˜¯ Elasticsearch æä¾›çš„ JSON é¢¨æ ¼çš„è«‹æ±‚èªå¥ï¼Œç”¨ä¾†æ“ä½œ Elasticsearchï¼Œå¯¦ä½œ CRUD</td></tr></tbody></table></div><p>åœ¨ä¼æ¥­ä¸­ï¼Œå¾€å¾€æ˜¯å…©è€…çµåˆä½¿ç”¨ï¼š</p><ul><li>å°å®‰å…¨æ€§è¦æ±‚è¼ƒé«˜çš„å¯«å…¥æ“ä½œï¼Œä½¿ç”¨ MySQL å¯¦ä½œã€‚</li><li>å°æŸ¥è©¢æ•ˆèƒ½è¦æ±‚è¼ƒé«˜çš„æœå°‹éœ€æ±‚ï¼Œä½¿ç”¨ Elasticsearch å¯¦ä½œã€‚</li><li>å…©è€…å†åŸºæ–¼æŸç¨®æ–¹å¼ï¼Œå¯¦ä½œè³‡æ–™çš„åŒæ­¥ï¼Œç¢ºä¿ä¸€è‡´æ€§ã€‚</li></ul><h3 id=å„ªç¼ºé»>å„ªç¼ºé»</h3><p><strong>æ­£å‘ç´¢å¼•</strong>ï¼š</p><ul><li>å„ªé»ï¼š<ul><li>å¯ä»¥çµ¦å¤šå€‹æ¬„ä½å»ºç«‹ç´¢å¼•ã€‚</li><li>æ ¹æ“šç´¢å¼•æ¬„ä½æœå°‹ã€æ’åºé€Ÿåº¦éå¸¸å¿«ã€‚</li></ul></li><li>ç¼ºé»ï¼š<ul><li>æ ¹æ“šéç´¢å¼•æ¬„ä½ï¼Œæˆ–è€…ç´¢å¼•æ¬„ä½ä¸­çš„éƒ¨åˆ†è©æ¢æŸ¥æ‰¾æ™‚ï¼Œåªèƒ½å…¨è¡¨æƒæã€‚</li></ul></li></ul><p><strong>å€’æ’ç´¢å¼•</strong>ï¼š</p><ul><li>å„ªé»ï¼š<ul><li>æ ¹æ“šè©æ¢æœå°‹ã€æ¨¡ç³Šæœå°‹æ™‚ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚</li></ul></li><li>ç¼ºé»ï¼š<ul><li>åªèƒ½çµ¦è©æ¢å»ºç«‹ç´¢å¼•ï¼Œè€Œä¸æ˜¯æ¬„ä½ã€‚</li><li>ç„¡æ³•æ ¹æ“šæ¬„ä½åšæ’åºã€‚</li></ul></li></ul><h2 id=å®‰è£>å®‰è£</h2><p>ä¸€èˆ¬åªç”¨ Elasticsearch å³å¯ï¼Œä½¿ç”¨ Kibana å¯ä»¥æä¾›ä¸€å€‹ Elasticsearch çš„è¦–è¦ºåŒ–ä»‹é¢ï¼Œæ–¹ä¾¿å­¸ç¿’æ’°å¯« DSL èªå¥ã€‚</p><h3 id=elasticsearch>Elasticsearch</h3><p>ç‚ºäº†ä½¿ Elasticsearch èˆ‡ Kibana å®¹å™¨äº’é€£ï¼Œå¯ä»¥å…ˆå»ºç«‹ä¸€å€‹ç¶²è·¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker network create es-net
</span></span></code></pre></td></tr></table></div></div><blockquote><p>æœ‰å¤šç¨®æ–¹å¼å¯ä»¥å¯¦ä½œäº’é€£ï¼Œå¦‚ docker-composeã€172.17.0.1</p></blockquote><p>æ‹‰å– Elasticsearch æ˜ åƒæª”ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull elasticsearch:7.12.1
</span></span></code></pre></td></tr></table></div></div><p>å–®é»éƒ¨ç½²</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --name es <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=s2>&#34;ES_JAVA_OPTS=-Xms512m -Xmx512m&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e <span class=s2>&#34;discovery.type=single-node&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v es-data:/usr/share/elasticsearch/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -v es-plugins:/usr/share/elasticsearch/plugins <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --privileged <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --network es-net <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -p 9200:9200 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -p 9300:9300 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>elasticsearch:7.12.1
</span></span></code></pre></td></tr></table></div></div><p>æ³¨æ„ä¿®æ”¹æ˜ å°„ç›®éŒ„ï¼Œä¸Šè¿°ä½¿ç”¨è³‡æ–™å· (volume)ï¼Œéƒ¨åˆ†è§£é‡‹ï¼š</p><ul><li><code>-e "cluster.name=es-docker-cluster"</code>ï¼šè¨­å®šå¢é›†åç¨±ã€‚</li><li><code>-e "http.host=0.0.0.0"</code>ï¼šç›£è½çš„ä½å€ï¼Œå¯ä»¥å¾å¤–éƒ¨ç¶²è·¯å­˜å–ã€‚</li><li><code>-e "ES_JAVA_OPTS=-Xms512m -Xmx512m"</code>ï¼šè¨˜æ†¶é«”å¤§å°ã€‚</li><li><code>-e "discovery.type=single-node"</code>ï¼šéå¢é›†æ¨¡å¼ã€‚</li><li><code>-v es-data:/usr/share/elasticsearch/data</code>ï¼šæ›è¼‰è³‡æ–™å·ï¼Œç¶å®š ES çš„è³‡æ–™ç›®éŒ„ã€‚</li><li><code>-v es-logs:/usr/share/elasticsearch/logs</code>ï¼šæ›è¼‰è³‡æ–™å·ï¼Œç¶å®š ES çš„æ—¥èªŒç›®éŒ„ã€‚</li><li><code>-v es-plugins:/usr/share/elasticsearch/plugins</code>ï¼šæ›è¼‰è³‡æ–™å·ï¼Œç¶å®š ES çš„æ’ä»¶ç›®éŒ„ã€‚</li><li><code>--privileged</code>ï¼šæˆäºˆè³‡æ–™å·å­˜å–æ¬Šã€‚</li><li><code>--network es-net</code> ï¼šåŠ å…¥ä¸€å€‹åç‚º es-net çš„ç¶²è·¯ä¸­ã€‚</li></ul><p>å­˜å– <code>&lt;localhost:9200></code> æŸ¥çœ‹å›å‚³é¡ä¼¼ä¸‹è¿°å…§å®¹å³è¡¨ç¤ºå•Ÿå‹•æˆåŠŸã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span> <span class=p>:</span> <span class=s2>&#34;6747e3f712ba&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cluster_name&#34;</span> <span class=p>:</span> <span class=s2>&#34;docker-cluster&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cluster_uuid&#34;</span> <span class=p>:</span> <span class=s2>&#34;GSLtjxiMSlyRRRW-pSzvWQ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;version&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;number&#34;</span> <span class=p>:</span> <span class=s2>&#34;7.12.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;build_flavor&#34;</span> <span class=p>:</span> <span class=s2>&#34;default&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;build_type&#34;</span> <span class=p>:</span> <span class=s2>&#34;docker&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;build_hash&#34;</span> <span class=p>:</span> <span class=s2>&#34;3186837139b9c6b6d23c3200870651f10d3343b7&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;build_date&#34;</span> <span class=p>:</span> <span class=s2>&#34;2021-04-20T20:56:39.040728659Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;build_snapshot&#34;</span> <span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;lucene_version&#34;</span> <span class=p>:</span> <span class=s2>&#34;8.8.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;minimum_wire_compatibility_version&#34;</span> <span class=p>:</span> <span class=s2>&#34;6.8.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;minimum_index_compatibility_version&#34;</span> <span class=p>:</span> <span class=s2>&#34;6.0.0-beta1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;tagline&#34;</span> <span class=p>:</span> <span class=s2>&#34;You Know, for Search&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=kibana>Kibana</h3><p>æ‹‰å–ç›¸åŒç‰ˆæœ¬çš„æ˜ åƒæª”ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker pull kibana:7.12.1
</span></span></code></pre></td></tr></table></div></div><p>åŸ·è¡Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--name kibana <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-e <span class=nv>ELASTICSEARCH_HOSTS</span><span class=o>=</span>http://es:9200 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--network<span class=o>=</span>es-net <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-p 5601:5601  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>kibana:7.12.1
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­ <code>-e ELASTICSEARCH_HOSTS=http://es:9200"</code>ï¼šè¨­å®š Elasticsearch çš„ä½å€ï¼Œå› ç‚º Kibana å·²ç¶“èˆ‡ Elasticsearch åœ¨åŒä¸€å€‹ç¶²è·¯ï¼Œå› æ­¤å¯ä»¥ç”¨å®¹å™¨åç¨±ç›´æ¥å­˜å– Elasticsearchã€‚</p><p>Kibana å•Ÿå‹•é€šå¸¸æ¯”è¼ƒæ…¢ï¼Œéœ€è¦å¤šç­‰ä¸€æœƒå…’ï¼Œå¯ä»¥æŸ¥çœ‹æ—¥èªŒï¼Œè‹¥å‡ºç¾é€£æ¥åŸ è™Ÿå‰‡è¡¨ç¤ºå•Ÿå‹•æˆåŠŸã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker logs -f kibana
</span></span></code></pre></td></tr></table></div></div><p>å­˜å– <code>&lt;localhost:5601></code> æŸ¥çœ‹çµæœã€‚</p><h3 id=ik-æ–·è©å™¨>IK æ–·è©å™¨</h3><p>ES åœ¨å»ºç«‹å€’æ’ç´¢å¼•æ™‚éœ€è¦å°æ–‡ä»¶æ–·è©ï¼›åœ¨æœå°‹æ™‚ï¼Œéœ€è¦å°ä½¿ç”¨è€…è¼¸å…¥å…§å®¹æ–·è©ã€‚ä½†é è¨­çš„æ–·è©è¦å‰‡å°ä¸­æ–‡è™•ç†ä¸å¤ªå‹å–„ï¼Œä¾‹å¦‚æ¸¬è©¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>æ¸¬è©¦æ–·è©</span>
</span></span><span class=line><span class=cl><span class=err>POST</span> <span class=err>/_analyze</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;standard&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;åˆæ¬¡ä½¿ç”¨ Elasticsearch&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>èªæ³•èªªæ˜ï¼š</p><ul><li>POSTï¼šè«‹æ±‚æ–¹å¼ã€‚</li><li>/_analyzeï¼šè«‹æ±‚è·¯å¾‘ã€‚é€™è£¡çœç•¥äº† <code>http://localhost:9200</code>ï¼Œç”± Kibana è£œå……ã€‚</li><li>è«‹æ±‚åƒæ•¸ä½¿ç”¨ JSONã€‚<ul><li>analyzerï¼šæ–·è©å™¨å‹åˆ¥ï¼Œé è¨­ç‚º standardã€‚</li><li>textï¼šéœ€è¦æ–·è©çš„å…§å®¹ã€‚</li></ul></li></ul><p>çµæœç‚ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;tokens&#34;</span> <span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;åˆ&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;æ¬¡&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;ä½¿&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;ç”¨&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;&lt;IDEOGRAPHIC&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;elasticsearch&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>18</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;&lt;ALPHANUM&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯ä»¥çœ‹åˆ°æ–·è©æ•ˆæœéå¸¸ä¸å¥½ï¼Œè™•ç†ä¸­æ–‡æ–·è©ï¼Œä¸€èˆ¬æœƒä½¿ç”¨ IK æ–·è©å™¨ã€‚</p><p>IK æ–·è©å™¨ Githubï¼š
<a class=link href=https://github.com/medcl/elasticsearch-analysis-ik target=_blank rel=noopener>https://github.com/medcl/elasticsearch-analysis-ik</a></p><h4 id=ç·šä¸Šå®‰è£>ç·šä¸Šå®‰è£</h4><p>æ³¨æ„å®‰è£ç‰ˆæœ¬éœ€èˆ‡ ES å°æ‡‰ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># é€²å…¥å®¹å™¨å…§éƒ¨</span>
</span></span><span class=line><span class=cl>docker <span class=nb>exec</span> -it elasticsearch /bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç·šä¸Šä¸‹è¼‰ä¸¦å®‰è£</span>
</span></span><span class=line><span class=cl>./bin/elasticsearch-plugin  install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.12.1/elasticsearch-analysis-ik-7.12.1.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é›¢é–‹</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=c1># é‡æ–°å•Ÿå‹•å®¹å™¨</span>
</span></span><span class=line><span class=cl>docker restart elasticsearch
</span></span></code></pre></td></tr></table></div></div><h4 id=é›¢ç·šå®‰è£>é›¢ç·šå®‰è£</h4><p>å®‰è£æ’ä»¶éœ€è¦çŸ¥é“ Elasticsearch çš„ <code>plugins</code> ç›®éŒ„ä½ç½®ï¼Œä¸Šè¿°ä½¿ç”¨è³‡æ–™å·æ›è¼‰åˆ°æœ¬æ©Ÿï¼Œå¯ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤æŸ¥çœ‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker volume inspect es-plugins
</span></span></code></pre></td></tr></table></div></div><p>è¼¸å‡ºçš„ JSON çš„ <code>Mountpoint</code> å³ç‚ºç›®éŒ„ã€‚</p><p>å°‡å¾ Github ä¸‹è¼‰çš„å£“ç¸®æª”è§£å£“ç¸®å¾Œï¼Œå°‡è³‡æ–™å¤¾é‡æ–°å‘½åç‚º <code>ik</code>ï¼Œæ”¾åˆ° <code>plugins</code> ç›®éŒ„ä¸‹ã€‚</p><p>é‡æ–°å•Ÿå‹•å®¹å™¨ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker restart es
</span></span></code></pre></td></tr></table></div></div><h4 id=æ¸¬è©¦æ•ˆæœ>æ¸¬è©¦æ•ˆæœ</h4><p>IK æ–·è©å™¨æœ‰å…©ç¨®æ¨¡å¼ï¼š</p><ul><li>ik_smartï¼šæœ€å°‘åˆ‡åˆ†ã€‚</li><li>ik_max_wordï¼šæœ€ç´°åˆ‡åˆ†ã€‚</li></ul><p>é‚„æ˜¯ä¸Šä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>æ¸¬è©¦</span> <span class=err>IK</span> <span class=err>æ–·è©</span>
</span></span><span class=line><span class=cl><span class=err>POST</span> <span class=err>/_analyze</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;ik_smart&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;åˆæ¬¡ä½¿ç”¨ Elasticsearch&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;tokens&#34;</span> <span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;åˆæ¬¡&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;CN_WORD&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;ä½¿ç”¨&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;CN_WORD&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;token&#34;</span> <span class=p>:</span> <span class=s2>&#34;elasticsearch&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;start_offset&#34;</span> <span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;end_offset&#34;</span> <span class=p>:</span> <span class=mi>18</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;ENGLISH&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;position&#34;</span> <span class=p>:</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>æ­¤ç¯„ä¾‹å…©ç¨®æ–·è©æ¨¡å¼çµæœç›¸åŒï¼Œå¯ä½¿ç”¨å…¶ä»–æ›´é•·èªå¥æ¸¬è©¦çµæœã€‚</p></blockquote><h4 id=æ“´å±•è©åº«>æ“´å±•è©åº«</h4><p>éš¨è‘—ç¶²éš›ç¶²è·¯ç™¼å±•ï¼Œæœƒä¸æ–·æ¹§ç¾æ–°è©èªï¼Œåœ¨åŸæœ‰çš„è©å½™åˆ—è¡¨ä¸­ä¸¦ä¸å­˜åœ¨ï¼Œæ‰€ä»¥è©å½™åˆ—è¡¨ä¹Ÿéœ€è¦ä¸æ–·æ›´æ–°ã€‚è‹¥æ“´å±• IK è©åº«ï¼Œåªéœ€è¦ä¿®æ”¹ IK ç›®éŒ„ <code>config</code> ç›®éŒ„ä¸­çš„ <code>IKAnalyzer.cfg.xml</code> æ–‡ä»¶å³å¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE properties SYSTEM &#34;http://java.sun.com/dtd/properties.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;properties&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;comment&gt;</span>IK Analyzer æ“´å±•è¨­å®š<span class=nt>&lt;/comment&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--ä½¿ç”¨è€…å¯ä»¥åœ¨é€™è£¡è¨­å®šè‡ªå·±çš„æ“´å±•å­—å…¸ --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;entry</span> <span class=na>key=</span><span class=s>&#34;ext_dict&#34;</span><span class=nt>&gt;</span>ext.dic<span class=nt>&lt;/entry&gt;</span>
</span></span><span class=line><span class=cl>     <span class=c>&lt;!--ä½¿ç”¨è€…å¯ä»¥åœ¨é€™è£¡è¨­å®šè‡ªå·±çš„æ“´å±•åœç”¨è©å­—å…¸--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;entry</span> <span class=na>key=</span><span class=s>&#34;ext_stopwords&#34;</span><span class=nt>&gt;</span>stopwords.dic<span class=nt>&lt;/entry&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--ä½¿ç”¨è€…å¯ä»¥åœ¨é€™è£¡è¨­å®šé ç«¯æ“´å±•å­—å…¸ --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- &lt;entry key=&#34;remote_ext_dict&#34;&gt;words_location&lt;/entry&gt; --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--ä½¿ç”¨è€…å¯ä»¥åœ¨é€™è£¡è¨­å®šé ç«¯æ“´å±•åœç”¨è©å­—å…¸--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- &lt;entry key=&#34;remote_ext_stopwords&#34;&gt;words_location&lt;/entry&gt; --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/properties&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚ä¸Šå°‡æ“´å±•è©æ”¾åœ¨ <code>./ext.dic</code>ï¼Œåœç”¨è©æ”¾åœ¨ <code>./stopwords.dic</code>ã€‚</p><p>åœç”¨è©å¯ä»¥æ”¾ä¸€äº›ç„¡æ„ç¾©çš„è©ï¼Œå¦‚ <em>çš„</em>ã€<em>å•Š</em> ç­‰ã€‚</p><p>è¨­å®šå¥½å¾Œé‡æ–°å•Ÿå‹• ESã€‚</p><h2 id=dsl-ç´¢å¼•åº«æ“ä½œ>DSL ç´¢å¼•åº«æ“ä½œ</h2><p>ç´¢å¼•åº«å°±é¡ä¼¼è³‡æ–™åº«è¡¨ï¼Œè¦å‘ ES ä¸­å„²å­˜è³‡æ–™ï¼Œå¿…é ˆå…ˆå»ºç«‹ã€Œåº«ã€å’Œã€Œè¡¨ã€ã€‚</p><h3 id=mapping-æ˜ å°„å±¬æ€§>Mapping æ˜ å°„å±¬æ€§</h3><p>Mapping æ˜¯å°ç´¢å¼•åº«ä¸­æ–‡ä»¶çš„é™åˆ¶ï¼Œå¸¸è¦‹çš„ Mapping å±¬æ€§åŒ…æ‹¬ï¼š</p><ul><li>typeï¼šæ¬„ä½è³‡æ–™å‹åˆ¥ï¼Œå¸¸è¦‹çš„ç°¡å–®å‹åˆ¥æœ‰ï¼š<ul><li>å­—ä¸²ï¼štextï¼ˆå¯æ–·è©çš„æ–‡å­—ï¼‰ã€keywordï¼ˆç²¾ç¢ºå€¼ï¼Œä¾‹å¦‚ï¼šå“ç‰Œã€åœ‹å®¶ã€IP ä½å€ï¼‰</li><li>æ•¸å€¼ï¼šlongã€integerã€shortã€byteã€doubleã€floatã€</li><li>å¸ƒæ—ï¼šboolean</li><li>æ—¥æœŸï¼šdate</li><li>ç‰©ä»¶ï¼šobject</li></ul></li><li>indexï¼šæ˜¯å¦å»ºç«‹ç´¢å¼•ï¼Œé è¨­ç‚º trueã€‚</li><li>analyzerï¼šä½¿ç”¨å“ªç¨®æ–·è©å™¨ã€‚</li><li>propertiesï¼šè©²æ¬„ä½çš„å­æ¬„ä½ã€‚</li></ul><h3 id=å»ºç«‹ç´¢å¼•åº«>å»ºç«‹ç´¢å¼•åº«</h3><ul><li>è«‹æ±‚æ–¹å¼ï¼šPUT</li><li>è«‹æ±‚è·¯å¾‘ï¼š/ç´¢å¼•åº«åç¨±ï¼Œå¯ä»¥è‡ªè¨‚ã€‚</li><li>è«‹æ±‚åƒæ•¸ï¼šmapping æ˜ å°„ã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>PUT</span>Â <span class=err>/ç´¢å¼•åº«åç¨±</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â <span class=nt>&#34;mappings&#34;</span><span class=p>:</span>Â <span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;properties&#34;</span><span class=p>:</span>Â <span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=nt>&#34;æ¬„ä½åç¨±&#34;</span><span class=p>:{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;type&#34;</span><span class=p>:</span>Â <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span>Â <span class=s2>&#34;ik_smart&#34;</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=p>},</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=nt>&#34;æ¬„ä½åç¨±2&#34;</span><span class=p>:{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;type&#34;</span><span class=p>:</span>Â <span class=s2>&#34;keyword&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;index&#34;</span><span class=p>:</span>Â <span class=s2>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=p>},</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=nt>&#34;æ¬„ä½åç¨±3&#34;</span><span class=p>:{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;properties&#34;</span><span class=p>:</span>Â <span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â Â Â <span class=nt>&#34;å­æ¬„ä½&#34;</span><span class=p>:</span>Â <span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â Â Â Â Â <span class=nt>&#34;type&#34;</span><span class=p>:</span>Â <span class=s2>&#34;keyword&#34;</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â Â Â <span class=p>}</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=p>}</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=c1>// code
</span></span></span><span class=line><span class=cl><span class=c1></span>Â Â Â Â <span class=p>}</span>
</span></span><span class=line><span class=cl>Â Â <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>å»ºç«‹ç´¢å¼•åº«</span>
</span></span><span class=line><span class=cl><span class=err>PUT</span> <span class=err>/hello</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;mappings&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;info&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;ik_smart&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;firstName&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;lastName&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åŸ·è¡Œå¾Œå›å‚³é¡ä¼¼å³æˆåŠŸï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;acknowledged&#34;</span> <span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;shards_acknowledged&#34;</span> <span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;index&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æŸ¥è©¢ç´¢å¼•åº«>æŸ¥è©¢ç´¢å¼•åº«</h3><ul><li><p>è«‹æ±‚æ–¹å¼ï¼šGET</p></li><li><p>è«‹æ±‚è·¯å¾‘ï¼š/ç´¢å¼•åº«åç¨±</p></li><li><p>è«‹æ±‚åƒæ•¸ï¼šç„¡</p></li></ul><p>æ ¼å¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>GET</span> <span class=err>/ç´¢å¼•åº«åç¨±</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>æŸ¥çœ‹ç´¢å¼•åº«</span>
</span></span><span class=line><span class=cl><span class=err>GET</span> <span class=err>/hello</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;hello&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;aliases&#34;</span> <span class=p>:</span> <span class=p>{</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;mappings&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;properties&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;email&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;keyword&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;index&#34;</span> <span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;info&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;analyzer&#34;</span> <span class=p>:</span> <span class=s2>&#34;ik_smart&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;properties&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;firstName&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;keyword&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;lastName&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;type&#34;</span> <span class=p>:</span> <span class=s2>&#34;keyword&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;settings&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;index&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;routing&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;allocation&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;include&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nt>&#34;_tier_preference&#34;</span> <span class=p>:</span> <span class=s2>&#34;data_content&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;number_of_shards&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;blocks&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;read_only_allow_delete&#34;</span> <span class=p>:</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;provided_name&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;creation_date&#34;</span> <span class=p>:</span> <span class=s2>&#34;1703683379263&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;number_of_replicas&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;uuid&#34;</span> <span class=p>:</span> <span class=s2>&#34;zn-kPdsETZeFcB0nXK79hg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;version&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;created&#34;</span> <span class=p>:</span> <span class=s2>&#34;7120199&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¿®æ”¹ç´¢å¼•åº«>ä¿®æ”¹ç´¢å¼•åº«</h3><p>ç´¢å¼•åº«å’Œ Mapping ä¸€æ—¦å»ºç«‹ï¼Œä¸å…è¨±ä¿®æ”¹ï¼Œä½†å¯ä»¥æ–°å¢æ¬„ä½ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>PUT</span>Â <span class=err>/ç´¢å¼•åº«åç¨±/_mapping</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â <span class=nt>&#34;properties&#34;</span><span class=p>:</span>Â <span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;æ–°æ¬„ä½åç¨±&#34;</span><span class=p>:{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â <span class=nt>&#34;type&#34;</span><span class=p>:</span>Â <span class=s2>&#34;integer&#34;</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=p>}</span>
</span></span><span class=line><span class=cl>Â Â <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>æ–°å¢æ¬„ä½</span>
</span></span><span class=line><span class=cl><span class=err>PUT</span> <span class=err>/hello/_mapping</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;age&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;integer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><p>å¦‚æœé‡åˆ° <code>read-only-allow-delete</code> é¡ä¼¼éŒ¯èª¤ï¼Œç”¢ç”ŸåŸå› ç‚ºç£ç¢Ÿå‰©é¤˜ç©ºé–“ä¸è¶³ 5%ï¼Œå¯é€éä»¥ä¸‹è«‹æ±‚è§£æ±ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>PUT</span> <span class=err>_settings</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;index&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;blocks&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;read_only_allow_delete&#34;</span><span class=p>:</span> <span class=s2>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆªé™¤ç´¢å¼•åº«>åˆªé™¤ç´¢å¼•åº«</h3><ul><li><p>è«‹æ±‚æ–¹å¼ï¼šDELETE</p></li><li><p>è«‹æ±‚è·¯å¾‘ï¼š/ç´¢å¼•åº«åç¨±</p></li><li><p>è«‹æ±‚åƒæ•¸ï¼šç„¡</p></li></ul><p>æ ¼å¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>DELETE</span> <span class=err>/ç´¢å¼•åº«åç¨±</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>DELETE</span> <span class=err>/hello</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;acknowledged&#34;</span> <span class=p>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ç´¢å¼•åº«æ“ä½œç¸½çµ>ç´¢å¼•åº«æ“ä½œç¸½çµ</h3><ul><li>å»ºç«‹ç´¢å¼•åº«ï¼šPUT /ç´¢å¼•åº«åç¨±</li><li>æŸ¥è©¢ç´¢å¼•åº«ï¼šGET /ç´¢å¼•åº«åç¨±</li><li>åˆªé™¤ç´¢å¼•åº«ï¼šDELETE /ç´¢å¼•åº«åç¨±</li><li>æ–°å¢æ¬„ä½ï¼šPUT /ç´¢å¼•åº«åç¨±/_mapping</li></ul><h2 id=dsl-æ–‡ä»¶æ“ä½œ>DSL æ–‡ä»¶æ“ä½œ</h2><h3 id=æ–°å¢æ–‡ä»¶>æ–°å¢æ–‡ä»¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>POST</span>Â <span class=err>/ç´¢å¼•åº«åç¨±/_doc/æ–‡ä»¶id</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;æ¬„ä½1&#34;</span><span class=p>:</span>Â <span class=s2>&#34;å€¼1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;æ¬„ä½2&#34;</span><span class=p>:</span>Â <span class=s2>&#34;å€¼2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;æ¬„ä½3&#34;</span><span class=p>:</span>Â <span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;å­å±¬æ€§1&#34;</span><span class=p>:</span>Â <span class=s2>&#34;å€¼3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>Â Â Â Â Â Â Â Â <span class=nt>&#34;å­å±¬æ€§2&#34;</span><span class=p>:</span>Â <span class=s2>&#34;å€¼4&#34;</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=c1>// code
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¯„ä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>æ–°å¢æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=err>PUT</span> <span class=err>/hello/_doc/</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;info&#34;</span><span class=p>:</span> <span class=s2>&#34;hello es&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;blog@yexca.net&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;firstName&#34;</span><span class=p>:</span> <span class=s2>&#34;yexca&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;lastName&#34;</span><span class=p>:</span> <span class=s2>&#34;Dale&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_index&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_type&#34;</span> <span class=p>:</span> <span class=s2>&#34;_doc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_id&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_version&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;result&#34;</span> <span class=p>:</span> <span class=s2>&#34;created&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_shards&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;total&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;successful&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;failed&#34;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_seq_no&#34;</span> <span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_primary_term&#34;</span> <span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æŸ¥è©¢æ–‡ä»¶>æŸ¥è©¢æ–‡ä»¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>GET</span> <span class=err>/</span><span class=p>{</span><span class=err>ç´¢å¼•åº«åç¨±</span><span class=p>}</span><span class=err>/_doc/</span><span class=p>{</span><span class=err>id</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¯„ä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>æŸ¥è©¢æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=err>GEt</span> <span class=err>/hello/_doc/</span><span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_index&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_type&#34;</span> <span class=p>:</span> <span class=s2>&#34;_doc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_id&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_version&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_seq_no&#34;</span> <span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_primary_term&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;found&#34;</span> <span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_source&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;info&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello es&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;email&#34;</span> <span class=p>:</span> <span class=s2>&#34;blog@yexca.net&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;firstName&#34;</span> <span class=p>:</span> <span class=s2>&#34;yexca&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;lastName&#34;</span> <span class=p>:</span> <span class=s2>&#34;Dale&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ä¿®æ”¹æ–‡ä»¶>ä¿®æ”¹æ–‡ä»¶</h3><p>ä¿®æ”¹æœ‰å…©ç¨®æ–¹å¼ï¼Œå®Œæ•´ä¿®æ”¹èˆ‡å¢é‡ä¿®æ”¹ã€‚</p><h4 id=å®Œæ•´ä¿®æ”¹>å®Œæ•´ä¿®æ”¹</h4><p>å®Œæ•´ä¿®æ”¹æ˜¯è¦†è“‹åŸä¾†çš„æ–‡ä»¶çš„å…§å®¹ï¼Œå…¶æœ¬è³ªæ˜¯ï¼š</p><ol><li>æ ¹æ“šæŒ‡å®šçš„ id åˆªé™¤æ–‡ä»¶ã€‚</li><li>æ–°å¢ä¸€å€‹ç›¸åŒ id çš„æ–‡ä»¶ã€‚</li></ol><p>å¦‚æœ id ä¸å­˜åœ¨ï¼Œä¹ŸæœƒåŸ·è¡Œç¬¬äºŒæ­¥ï¼Œä¹Ÿå°±å¾ä¿®æ”¹è®Šæˆæ–°å¢äº† (è¦†è“‹å¯«å…¥)ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>PUT</span>Â <span class=err>/</span><span class=p>{</span><span class=err>ç´¢å¼•åº«åç¨±</span><span class=p>}</span><span class=err>/_doc/æ–‡ä»¶id</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;æ¬„ä½1&#34;</span><span class=p>:</span>Â <span class=s2>&#34;å€¼1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;æ¬„ä½2&#34;</span><span class=p>:</span>Â <span class=s2>&#34;å€¼2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1>// code
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>ä¿®æ”¹-å®Œæ•´ä¿®æ”¹</span>
</span></span><span class=line><span class=cl><span class=err>PUT</span> <span class=err>/hello/_doc/</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;info&#34;</span><span class=p>:</span> <span class=s2>&#34;hello es&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;es@yexca.net&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;firstName&#34;</span><span class=p>:</span> <span class=s2>&#34;yexca&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;lastName&#34;</span><span class=p>:</span> <span class=s2>&#34;Dale&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_index&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_type&#34;</span> <span class=p>:</span> <span class=s2>&#34;_doc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_id&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_version&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;result&#34;</span> <span class=p>:</span> <span class=s2>&#34;updated&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_shards&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;total&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;successful&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;failed&#34;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_seq_no&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_primary_term&#34;</span> <span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æŸ¥è©¢å¯ç™¼ç¾ä¿¡ç®±å·²ç¶“ä¿®æ”¹ã€‚</p><h4 id=å¢é‡ä¿®æ”¹>å¢é‡ä¿®æ”¹</h4><p>å¢é‡ä¿®æ”¹æ˜¯åªä¿®æ”¹æŒ‡å®š id åŒ¹é…çš„æ–‡ä»¶ä¸­çš„éƒ¨åˆ†æ¬„ä½ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>POST</span>Â <span class=err>/</span><span class=p>{</span><span class=err>ç´¢å¼•åº«åç¨±</span><span class=p>}</span><span class=err>/_update/æ–‡ä»¶id</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>Â Â Â Â <span class=nt>&#34;doc&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>         <span class=nt>&#34;æ¬„ä½åç¨±&#34;</span><span class=p>:</span>Â <span class=s2>&#34;æ–°çš„å€¼&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>ä¿®æ”¹-å¢é‡ä¿®æ”¹</span>
</span></span><span class=line><span class=cl><span class=err>POST</span> <span class=err>/hello/_update/</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;doc&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;blog@yexca.net&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_index&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_type&#34;</span> <span class=p>:</span> <span class=s2>&#34;_doc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_id&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_version&#34;</span> <span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;result&#34;</span> <span class=p>:</span> <span class=s2>&#34;updated&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_shards&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;total&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;successful&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;failed&#34;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_seq_no&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_primary_term&#34;</span> <span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æŸ¥è©¢å¯ç™¼ç¾ä¿¡ç®±å·²ç¶“ä¿®æ”¹ã€‚</p><h3 id=åˆªé™¤æ–‡ä»¶>åˆªé™¤æ–‡ä»¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>DELETE</span> <span class=err>/</span><span class=p>{</span><span class=err>ç´¢å¼•åº«åç¨±</span><span class=p>}</span><span class=err>/_doc/idå€¼</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>#</span> <span class=err>åˆªé™¤æ–‡ä»¶</span>
</span></span><span class=line><span class=cl><span class=err>DELETE</span> <span class=err>/hello/_doc/</span><span class=mi>1</span>
</span></span></code></pre></td></tr></table></div></div><p>çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_index&#34;</span> <span class=p>:</span> <span class=s2>&#34;hello&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_type&#34;</span> <span class=p>:</span> <span class=s2>&#34;_doc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_id&#34;</span> <span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å› ç‚ºä¸­é–“æˆ‘ä¿®æ”¹äº†å…¶ä»–çš„ï¼Œç‰ˆæœ¬è™Ÿè®Šé«˜äº†
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nt>&#34;_version&#34;</span> <span class=p>:</span> <span class=mi>8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;result&#34;</span> <span class=p>:</span> <span class=s2>&#34;deleted&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_shards&#34;</span> <span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;total&#34;</span> <span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;successful&#34;</span> <span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;failed&#34;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_seq_no&#34;</span> <span class=p>:</span> <span class=mi>7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;_primary_term&#34;</span> <span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ–‡ä»¶æ“ä½œç¸½çµ>æ–‡ä»¶æ“ä½œç¸½çµ</h3><ul><li>æ–°å¢æ–‡ä»¶ï¼šPOST /{ç´¢å¼•åº«åç¨±}/_doc/æ–‡ä»¶id { json æ–‡ä»¶ }</li><li>æŸ¥è©¢æ–‡ä»¶ï¼šGET /{ç´¢å¼•åº«åç¨±}/_doc/æ–‡ä»¶id</li><li>åˆªé™¤æ–‡ä»¶ï¼šDELETE /{ç´¢å¼•åº«åç¨±}/_doc/æ–‡ä»¶id</li><li>ä¿®æ”¹æ–‡ä»¶ï¼š<ul><li>å®Œæ•´ä¿®æ”¹ï¼šPUT /{ç´¢å¼•åº«åç¨±}/_doc/æ–‡ä»¶id { json æ–‡ä»¶ }</li><li>å¢é‡ä¿®æ”¹ï¼šPOST /{ç´¢å¼•åº«åç¨±}/_update/æ–‡ä»¶id { &ldquo;doc&rdquo;: {æ¬„ä½}}</li></ul></li></ul></section><footer class=article-footer><section class=article-tags><a href=/zh-tw/tags/%E5%BE%8C%E7%AB%AF%E6%8A%80%E8%A1%93/>å¾Œç«¯æŠ€è¡“</a>
<a href=/zh-tw/tags/elasticsearch/>Elasticsearch</a>
<a href=/zh-tw/tags/springcloud/>SpringCloud</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>This post is licensed under CC BY-NC-SA 4.0 by the author.</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>æœ€å¾Œæ›´æ–° 2025-02-15 17:17 +0900</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸é—œæ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/zh-tw/archives/217/><div class=article-details><h2 class=article-title>SpringAMQP</h2></div></a></article><article><a href=/zh-tw/archives/171/><div class=article-details><h2 class=article-title>Gateway æœå‹™é–˜é“å™¨</h2></div></a></article><article><a href=/zh-tw/archives/170/><div class=article-details><h2 class=article-title>Feign é ç«¯å‘¼å«</h2></div></a></article><article><a href=/zh-tw/archives/169/><div class=article-details><h2 class=article-title>Nacos è¨»å†Šä¸­å¿ƒ</h2></div></a></article><article><a href=/zh-tw/archives/168/><div class=article-details><h2 class=article-title>Ribbon è² è¼‰å¹³è¡¡</h2></div></a></article></div></div></aside><script src=//cdn.jsdelivr.net/npm/twikoo@1.6.39/dist/twikoo.all.min.js></script><div id=tcomment></div><style>.twikoo{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}:root[data-scheme=dark]{--twikoo-body-text-color-main:rgba(255, 255, 255, 0.9);--twikoo-body-text-color:rgba(255, 255, 255, 0.7)}.twikoo .el-input-group__prepend,.twikoo .tk-action-icon,.twikoo .tk-submit-action-icon,.twikoo .tk-time,.twikoo .tk-comments-no,.twikoo .tk-comments-count{color:var(--twikoo-body-text-color)}.twikoo .el-input__inner,.twikoo .el-textarea__inner,.twikoo .tk-preview-container,.twikoo .tk-content,.twikoo .tk-nick,.twikoo .tk-send{color:var(--twikoo-body-text-color-main)}.twikoo .el-button{color:var(--twikoo-body-text-color)!important}.twikoo .el-input__count{color:var(--twikoo-body-text-color)!important}.OwO .OwO-body{background-color:var(--body-background)!important;color:var(--body-text-color)!important}</style><script>twikoo.init({envId:"https://twikoo-jade-one.vercel.app/",el:"#tcomment"})</script><footer class=site-footer><section class=copyright>&copy;
2021 -
2026 <a href=https://blog.yexca.net target=_blank class=link rel=noopener>yexca</a></section><section class=powerby><p><span id=htmer_time style=color:var(--themecolor)></span></p><img src=https://count.getloli.com/@yexca><p>Visits Since 2025-02-28</p>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank class=link rel=noopener>Hugo</a> å»ºç«‹ <span>|</span>
ä¸»é¡Œ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank class=link rel=noopener data-version=3.29.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank class=link rel=noopener>Jimmy</a> è¨­è¨ˆ</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script>function secondToDate(e){if(!e)return 0;var t=new Array(0,0,0,0,0);return e>=365*24*3600&&(t[0]=parseInt(e/(365*24*3600)),e%=365*24*3600),e>=24*3600&&(t[1]=parseInt(e/(24*3600)),e%=24*3600),e>=3600&&(t[2]=parseInt(e/3600),e%=3600),e>=60&&(t[3]=parseInt(e/60),e%=60),e>0&&(t[4]=e),t}</script><script type=text/javascript language=javascript>function setTime(){var e=Math.round(new Date(Date.UTC(2021,10,6,14,15,19)).getTime()/1e3),t=Math.round(((new Date).getTime()+8*60*60*1e3)/1e3);currentTime=secondToDate(t-e),currentTimeHtml="This blog has been running for "+currentTime[0]+" years "+currentTime[1]+" days "+currentTime[2]+" hours "+currentTime[3]+" minutes "+currentTime[4]+" seconds",document.getElementById("htmer_time").innerHTML=currentTimeHtml}setInterval(setTime,1e3)</script></body></html>